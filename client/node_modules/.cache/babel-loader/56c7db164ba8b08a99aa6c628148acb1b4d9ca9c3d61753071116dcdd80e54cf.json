{"ast":null,"code":"import React,{useEffect,useRef,useState}from'react';import\"../styles/ProfilePic.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";let base_uri=process.env.REACT_APP_BASE_URL;export default function ProfilePic(_ref){let{changeProfile}=_ref;const hiddenFileInput=useRef(null);const[image,setImage]=useState(\"\");const[url,setUrl]=useState(\"\");//posting image to cloudinary\nconst postDetails=()=>{const data=new FormData();data.append(\"file\",image);data.append(\"upload_preset\",\"instagram\");data.append(\"cloud_name\",\"vishalranjan\");fetch(\"https://api.cloudinary.com/v1_1/vishalranjan/image/upload\",{method:\"post\",body:data}).then(res=>res.json()).then(data=>setUrl(data.url)).catch(err=>console.log(err));};const postPic=()=>{//saving post to mongodb\nfetch(\"\".concat(base_uri,\"/uploadProfilePic\"),{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({pic:url})}).then(res=>res.json()).then(data=>{changeProfile();window.location.reload();}).catch(err=>console.log(err));};const handleClick=()=>{hiddenFileInput.current.click();};useEffect(()=>{if(image){postDetails();}},[image]);useEffect(()=>{if(url){postPic();}},[url]);return/*#__PURE__*/_jsx(\"div\",{className:\"profilePic darkBg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"changePic centered\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Change Profile Photo\"})}),/*#__PURE__*/_jsxs(\"div\",{style:{borderTop:\"1px solid #00000030\"},children:[/*#__PURE__*/_jsx(\"button\",{className:\"upload-btn\",style:{color:\"#1EA1F7\"},onClick:handleClick,children:\"Upload Photo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:hiddenFileInput,accept:\"image/*\",style:{display:\"none\"},onChange:e=>{setImage(e.target.files[0]);}})]}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:\"1px solid #00000030\"},children:/*#__PURE__*/_jsx(\"button\",{className:\"upload-btn\",style:{color:\"#ED4956 \"},onClick:()=>{setUrl(null);postPic();},children:\"Remove Current Photo\"})}),/*#__PURE__*/_jsx(\"div\",{style:{borderTop:\"1px solid #00000030\"},children:/*#__PURE__*/_jsx(\"button\",{style:{background:\"none\",border:\"none\",cursor:\"pointer\",fontSize:\"15px\"},onClick:changeProfile,children:\"Cancel\"})})]})});}","map":{"version":3,"names":["React","useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","base_uri","process","env","REACT_APP_BASE_URL","ProfilePic","_ref","changeProfile","hiddenFileInput","image","setImage","url","setUrl","postDetails","data","FormData","append","fetch","method","body","then","res","json","catch","err","console","log","postPic","concat","headers","localStorage","getItem","JSON","stringify","pic","window","location","reload","handleClick","current","click","className","children","style","borderTop","color","onClick","type","ref","accept","display","onChange","e","target","files","background","border","cursor","fontSize"],"sources":["C:/insta/demo/MERN-Instagram-clone-main/client/src/components/screens/ProfilePic.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\nimport \"../styles/ProfilePic.css\"\nlet base_uri = process.env.REACT_APP_BASE_URL\n\nexport default function ProfilePic({changeProfile}) {\n\n    const hiddenFileInput = useRef(null)\n    const [image, setImage] = useState(\"\")\n    const [url, setUrl] = useState(\"\")\n\n     //posting image to cloudinary\n     const postDetails =()=>{\n        const data = new FormData()\n        data.append(\"file\", image)\n        data.append(\"upload_preset\", \"instagram\")\n        data.append(\"cloud_name\", \"vishalranjan\")\n\n        fetch(\"https://api.cloudinary.com/v1_1/vishalranjan/image/upload\", {\n            method: \"post\",\n            body: data\n        }).then(res => res.json())\n        .then(data => setUrl(data.url))\n        .catch(err => console.log(err))\n    }\n\n    const postPic =()=>{\n        //saving post to mongodb\n        fetch(`${base_uri}/uploadProfilePic`, {\n            method: \"put\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Authorization\": \"Bearer \"+ localStorage.getItem(\"jwt\")\n            },\n            body: JSON.stringify({\n                pic: url\n            })\n        }).then(res => res.json())\n        .then(data => {\n            changeProfile();\n            window.location.reload()\n        })\n        .catch(err => console.log(err))\n    }\n\n    const handleClick =()=>{\n        hiddenFileInput.current.click()\n    }\n\n    useEffect(()=>{\n        if(image){\n            postDetails();\n        }\n    }, [image])\n\n    useEffect(()=>{\n        if(url){\n            postPic()\n        }\n    }, [url])\n\n  return (\n    <div className=\"profilePic darkBg\">\n        <div className=\"changePic centered\">\n            <div>\n                <h2>Change Profile Photo</h2>\n            </div>\n            <div style={{borderTop: \"1px solid #00000030\"}}>\n                <button className=\"upload-btn\" style={{color: \"#1EA1F7\"}} onClick={handleClick} >Upload Photo</button>\n                <input type=\"file\" ref={hiddenFileInput} accept='image/*' style={{display: \"none\"}} onChange={(e)=>{setImage(e.target.files[0])}} />\n            </div>\n            <div style={{borderTop: \"1px solid #00000030\"}}>\n                <button className=\"upload-btn\" style={{color: \"#ED4956 \"}} onClick={()=>{\n                    setUrl(null)\n                    postPic()\n                }} >\n                    Remove Current Photo\n                </button>\n            </div>  \n            <div style={{borderTop: \"1px solid #00000030\"}} >\n                <button style={{background:\"none\", border: \"none\", cursor:\"pointer\", fontSize: \"15px\"}} onClick={changeProfile} >Cancel</button>\n            </div>\n        </div>\n    </div>\n  )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}